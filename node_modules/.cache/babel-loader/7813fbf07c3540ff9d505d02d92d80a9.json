{"ast":null,"code":"var _jsxFileName = \"/Users/sze/Desktop/chatroom-wechat/chatroom/src/Sidebar.js\";\nimport React, { useEffect, useState } from 'react';\nimport './Sidebar.css';\nimport { Avatar, IconButton } from '@material-ui/core';\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp'; // import SearchOutlined from '@material-ui/icons/SearchOutlined';\n\nimport SidebarChat from './SidebarChat';\nimport db from './firebase';\nimport { useStateValue } from './StateProvider';\nimport { firestore } from 'firebase';\n\nfunction Sidebar() {\n  const [rooms, setRooms] = useState([]);\n  const [check, setCheck] = useState(1);\n  const [{\n    user\n  }, dispatch] = useStateValue();\n  useEffect(() => {\n    const unsubscribe = db.collection('rooms').onSnapshot(snapshot => setRooms(snapshot.docs.map(doc => ({\n      id: doc.id,\n      data: doc.data()\n    }))));\n    return () => {\n      unsubscribe();\n    };\n  }, [check]);\n\n  const deleteRoom = id => {\n    db.collection('rooms').doc(id).collection('message').delete() // const roomRef = db.collection('rooms').doc(id)\n    // const removeRoom = roomRef.update({\n    // \tname: firestore.FieldValue.delete()\n    // })\n    .then(() => {\n      setCheck(!check);\n      console.log('succesfull delete message');\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sidebar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sidebar__header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Avatar, {\n    src: `https://avatars.dicebear.com/api/bottts/${user.displayName}.svg`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 5\n    }\n  }, user.displayName), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sidebar__headerRight\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(ExitToAppIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sidebar__chats\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(SidebarChat, {\n    addNewChat: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 5\n    }\n  }), rooms.map(room => /*#__PURE__*/React.createElement(SidebarChat, {\n    key: room.id,\n    id: room.id,\n    name: room.data.name,\n    deleteroom: deleteRoom,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 6\n    }\n  }))));\n}\n\nexport default Sidebar;","map":{"version":3,"sources":["/Users/sze/Desktop/chatroom-wechat/chatroom/src/Sidebar.js"],"names":["React","useEffect","useState","Avatar","IconButton","ExitToAppIcon","SidebarChat","db","useStateValue","firestore","Sidebar","rooms","setRooms","check","setCheck","user","dispatch","unsubscribe","collection","onSnapshot","snapshot","docs","map","doc","id","data","deleteRoom","delete","then","console","log","displayName","room","name"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAO,eAAP;AACA,SAASC,MAAT,EAAiBC,UAAjB,QAAmC,mBAAnC;AACA,OAAOC,aAAP,MAA0B,8BAA1B,C,CACA;;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,EAAP,MAAe,YAAf;AACA,SAASC,aAAT,QAA8B,iBAA9B;AACA,SAASC,SAAT,QAA0B,UAA1B;;AAEA,SAASC,OAAT,GAAmB;AAClB,QAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBV,QAAQ,CAAC,EAAD,CAAlC;AACA,QAAM,CAACW,KAAD,EAAQC,QAAR,IAAoBZ,QAAQ,CAAC,CAAD,CAAlC;AACA,QAAM,CAAC;AAAEa,IAAAA;AAAF,GAAD,EAAWC,QAAX,IAAuBR,aAAa,EAA1C;AAEAP,EAAAA,SAAS,CAAC,MAAM;AACf,UAAMgB,WAAW,GAAGV,EAAE,CAACW,UAAH,CAAc,OAAd,EAAuBC,UAAvB,CAAmCC,QAAD,IACrDR,QAAQ,CACPQ,QAAQ,CAACC,IAAT,CAAcC,GAAd,CAAmBC,GAAD,KAAU;AAC3BC,MAAAA,EAAE,EAAED,GAAG,CAACC,EADmB;AAE3BC,MAAAA,IAAI,EAAEF,GAAG,CAACE,IAAJ;AAFqB,KAAV,CAAlB,CADO,CADW,CAApB;AAQA,WAAO,MAAM;AACZR,MAAAA,WAAW;AACX,KAFD;AAGA,GAZQ,EAYN,CAACJ,KAAD,CAZM,CAAT;;AAcA,QAAMa,UAAU,GAAIF,EAAD,IAAQ;AAC1BjB,IAAAA,EAAE,CAACW,UAAH,CAAc,OAAd,EACEK,GADF,CACMC,EADN,EAEEN,UAFF,CAEa,SAFb,EAGES,MAHF,GAKC;AACA;AACA;AACA;AARD,KASEC,IATF,CASO,MAAM;AACXd,MAAAA,QAAQ,CAAC,CAACD,KAAF,CAAR;AACAgB,MAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACA,KAZF;AAaA,GAdD;;AAgBA,sBACC;AAAK,IAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACC;AAAK,IAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACC,oBAAC,MAAD;AACC,IAAA,GAAG,EAAG,2CAA0Cf,IAAI,CAACgB,WAAY,MADlE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,eAIC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAKhB,IAAI,CAACgB,WAAV,CAJD,eAKC;AAAK,IAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACC,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACC,oBAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,CADD,CALD,CADD,eAkBC;AAAK,IAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACC,oBAAC,WAAD;AAAa,IAAA,UAAU,MAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,EAEEpB,KAAK,CAACW,GAAN,CAAWU,IAAD,iBACV,oBAAC,WAAD;AACC,IAAA,GAAG,EAAEA,IAAI,CAACR,EADX;AAEC,IAAA,EAAE,EAAEQ,IAAI,CAACR,EAFV;AAGC,IAAA,IAAI,EAAEQ,IAAI,CAACP,IAAL,CAAUQ,IAHjB;AAIC,IAAA,UAAU,EAAEP,UAJb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADA,CAFF,CAlBD,CADD;AAgCA;;AAED,eAAehB,OAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport './Sidebar.css';\nimport { Avatar, IconButton } from '@material-ui/core';\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp';\n// import SearchOutlined from '@material-ui/icons/SearchOutlined';\nimport SidebarChat from './SidebarChat';\nimport db from './firebase';\nimport { useStateValue } from './StateProvider';\nimport { firestore } from 'firebase';\n\nfunction Sidebar() {\n\tconst [rooms, setRooms] = useState([]);\n\tconst [check, setCheck] = useState(1);\n\tconst [{ user }, dispatch] = useStateValue();\n\n\tuseEffect(() => {\n\t\tconst unsubscribe = db.collection('rooms').onSnapshot((snapshot) =>\n\t\t\tsetRooms(\n\t\t\t\tsnapshot.docs.map((doc) => ({\n\t\t\t\t\tid: doc.id,\n\t\t\t\t\tdata: doc.data(),\n\t\t\t\t}))\n\t\t\t)\n\t\t);\n\t\treturn () => {\n\t\t\tunsubscribe();\n\t\t};\n\t}, [check]);\n\n\tconst deleteRoom = (id) => {\n\t\tdb.collection('rooms')\n\t\t\t.doc(id)\n\t\t\t.collection('message')\n\t\t\t.delete()\n\n\t\t\t// const roomRef = db.collection('rooms').doc(id)\n\t\t\t// const removeRoom = roomRef.update({\n\t\t\t// \tname: firestore.FieldValue.delete()\n\t\t\t// })\n\t\t\t.then(() => {\n\t\t\t\tsetCheck(!check);\n\t\t\t\tconsole.log('succesfull delete message');\n\t\t\t});\n\t};\n\n\treturn (\n\t\t<div className='sidebar'>\n\t\t\t<div className='sidebar__header'>\n\t\t\t\t<Avatar\n\t\t\t\t\tsrc={`https://avatars.dicebear.com/api/bottts/${user.displayName}.svg`}\n\t\t\t\t/>\n\t\t\t\t<h2>{user.displayName}</h2>\n\t\t\t\t<div className='sidebar__headerRight'>\n\t\t\t\t\t<IconButton>\n\t\t\t\t\t\t<ExitToAppIcon />\n\t\t\t\t\t</IconButton>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{/* <div className='sidebar__search'>\n\t\t\t\t<div className='sidebar__searchContainer'>\n\t\t\t\t\t<SearchOutlined />\n\t\t\t\t\t<input placeholder='搜索聊天房间' type='text' />\n\t\t\t\t</div>\n\t\t\t</div> */}\n\t\t\t<div className='sidebar__chats'>\n\t\t\t\t<SidebarChat addNewChat />\n\t\t\t\t{rooms.map((room) => (\n\t\t\t\t\t<SidebarChat\n\t\t\t\t\t\tkey={room.id}\n\t\t\t\t\t\tid={room.id}\n\t\t\t\t\t\tname={room.data.name}\n\t\t\t\t\t\tdeleteroom={deleteRoom}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default Sidebar;\n"]},"metadata":{},"sourceType":"module"}