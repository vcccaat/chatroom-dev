{"ast":null,"code":"import _slicedToArray from\"/Users/sze/Desktop/chatroom-wechat/chatroom/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import'./Sidebar.css';import{Avatar,IconButton}from'@material-ui/core';import ExitToAppIcon from'@material-ui/icons/ExitToApp';// import SearchOutlined from '@material-ui/icons/SearchOutlined';\nimport SidebarChat from'./SidebarChat';import db from'./firebase';import{useStateValue}from'./StateProvider';import{firestore}from'firebase';function Sidebar(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),rooms=_useState2[0],setRooms=_useState2[1];var _useStateValue=useStateValue(),_useStateValue2=_slicedToArray(_useStateValue,2),user=_useStateValue2[0].user,dispatch=_useStateValue2[1];useEffect(function(){var unsubscribe=db.collection('rooms').onSnapshot(function(snapshot){return setRooms(snapshot.docs.map(function(doc){return{id:doc.id,data:doc.data()};}));});return function(){unsubscribe();};});var exitAccount=function exitAccount(){localStorage.clear();window.location.reload();};return/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar__header\"},/*#__PURE__*/React.createElement(Avatar,{src:\"https://avatars.dicebear.com/api/bottts/\".concat(user.displayName,\".svg\")}),/*#__PURE__*/React.createElement(\"h2\",null,user.displayName),/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar__headerRight\",onClick:exitAccount},/*#__PURE__*/React.createElement(IconButton,null,/*#__PURE__*/React.createElement(ExitToAppIcon,null)))),/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar__chats\"},/*#__PURE__*/React.createElement(SidebarChat,{addNewChat:true}),rooms.map(function(room){return/*#__PURE__*/React.createElement(SidebarChat,{key:room.id,id:room.id,name:room.data.name});})));}export default Sidebar;","map":{"version":3,"sources":["/Users/sze/Desktop/chatroom-wechat/chatroom/src/Sidebar.js"],"names":["React","useEffect","useState","Avatar","IconButton","ExitToAppIcon","SidebarChat","db","useStateValue","firestore","Sidebar","rooms","setRooms","user","dispatch","unsubscribe","collection","onSnapshot","snapshot","docs","map","doc","id","data","exitAccount","localStorage","clear","window","location","reload","displayName","room","name"],"mappings":"kKAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,MAAO,eAAP,CACA,OAASC,MAAT,CAAiBC,UAAjB,KAAmC,mBAAnC,CACA,MAAOC,CAAAA,aAAP,KAA0B,8BAA1B,CACA;AACA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,CACA,MAAOC,CAAAA,EAAP,KAAe,YAAf,CACA,OAASC,aAAT,KAA8B,iBAA9B,CACA,OAASC,SAAT,KAA0B,UAA1B,CAEA,QAASC,CAAAA,OAAT,EAAmB,eACQR,QAAQ,CAAC,EAAD,CADhB,wCACXS,KADW,eACJC,QADI,kCAGWJ,aAAa,EAHxB,kDAGTK,IAHS,oBAGTA,IAHS,CAGDC,QAHC,oBAKlBb,SAAS,CAAC,UAAM,CACf,GAAMc,CAAAA,WAAW,CAAGR,EAAE,CAACS,UAAH,CAAc,OAAd,EAAuBC,UAAvB,CAAkC,SAACC,QAAD,QACrDN,CAAAA,QAAQ,CACPM,QAAQ,CAACC,IAAT,CAAcC,GAAd,CAAkB,SAACC,GAAD,QAAU,CAC3BC,EAAE,CAAED,GAAG,CAACC,EADmB,CAE3BC,IAAI,CAAEF,GAAG,CAACE,IAAJ,EAFqB,CAAV,EAAlB,CADO,CAD6C,EAAlC,CAApB,CAQA,MAAO,WAAM,CACZR,WAAW,GACX,CAFD,CAGA,CAZQ,CAAT,CAcA,GAAMS,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACzBC,YAAY,CAACC,KAAb,GACAC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GACA,CAHD,CAKA,mBACC,2BAAK,SAAS,CAAC,SAAf,eACC,2BAAK,SAAS,CAAC,iBAAf,eACC,oBAAC,MAAD,EACC,GAAG,mDAA6ChB,IAAI,CAACiB,WAAlD,QADJ,EADD,cAIC,8BAAKjB,IAAI,CAACiB,WAAV,CAJD,cAKC,2BAAK,SAAS,CAAC,sBAAf,CAAsC,OAAO,CAAEN,WAA/C,eACC,oBAAC,UAAD,mBACC,oBAAC,aAAD,MADD,CADD,CALD,CADD,cAkBC,2BAAK,SAAS,CAAC,gBAAf,eACC,oBAAC,WAAD,EAAa,UAAU,KAAvB,EADD,CAEEb,KAAK,CAACS,GAAN,CAAU,SAACW,IAAD,qBACV,oBAAC,WAAD,EAAa,GAAG,CAAEA,IAAI,CAACT,EAAvB,CAA2B,EAAE,CAAES,IAAI,CAACT,EAApC,CAAwC,IAAI,CAAES,IAAI,CAACR,IAAL,CAAUS,IAAxD,EADU,EAAV,CAFF,CAlBD,CADD,CA2BA,CAED,cAAetB,CAAAA,OAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport './Sidebar.css';\nimport { Avatar, IconButton } from '@material-ui/core';\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp';\n// import SearchOutlined from '@material-ui/icons/SearchOutlined';\nimport SidebarChat from './SidebarChat';\nimport db from './firebase';\nimport { useStateValue } from './StateProvider';\nimport { firestore } from 'firebase';\n\nfunction Sidebar() {\n\tconst [rooms, setRooms] = useState([]);\n\n\tconst [{ user }, dispatch] = useStateValue();\n\n\tuseEffect(() => {\n\t\tconst unsubscribe = db.collection('rooms').onSnapshot((snapshot) =>\n\t\t\tsetRooms(\n\t\t\t\tsnapshot.docs.map((doc) => ({\n\t\t\t\t\tid: doc.id,\n\t\t\t\t\tdata: doc.data(),\n\t\t\t\t}))\n\t\t\t)\n\t\t);\n\t\treturn () => {\n\t\t\tunsubscribe();\n\t\t};\n\t});\n\n\tconst exitAccount = () => {\n\t\tlocalStorage.clear();\n\t\twindow.location.reload();\n\t};\n\n\treturn (\n\t\t<div className='sidebar'>\n\t\t\t<div className='sidebar__header'>\n\t\t\t\t<Avatar\n\t\t\t\t\tsrc={`https://avatars.dicebear.com/api/bottts/${user.displayName}.svg`}\n\t\t\t\t/>\n\t\t\t\t<h2>{user.displayName}</h2>\n\t\t\t\t<div className='sidebar__headerRight' onClick={exitAccount}>\n\t\t\t\t\t<IconButton>\n\t\t\t\t\t\t<ExitToAppIcon />\n\t\t\t\t\t</IconButton>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{/* <div className='sidebar__search'>\n\t\t\t\t<div className='sidebar__searchContainer'>\n\t\t\t\t\t<SearchOutlined />\n\t\t\t\t\t<input placeholder='搜索聊天房间' type='text' />\n\t\t\t\t</div>\n\t\t\t</div> */}\n\t\t\t<div className='sidebar__chats'>\n\t\t\t\t<SidebarChat addNewChat />\n\t\t\t\t{rooms.map((room) => (\n\t\t\t\t\t<SidebarChat key={room.id} id={room.id} name={room.data.name} />\n\t\t\t\t))}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default Sidebar;\n"]},"metadata":{},"sourceType":"module"}